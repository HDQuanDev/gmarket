<?php
header("Content-type: application/json");
include("../config.php");

if(isset($_POST['id']) && isset($_POST['quantity'])){
    $index=$_POST['id'];
    $quantity=$_POST['quantity'];
    
    $new_data=[];
    $i=0;
    foreach($_SESSION['cart'] as $cart){
        $i++;
        if($i==$index){
            $new_data[]=array(
                "name"=>$cart['name'],
                "price"=>$cart['price'],
                "img"=>$cart['img'],
                "quantity"=>$quantity,
            );
        }
        else{
            $new_data[]=array(
                "name"=>$cart['name'],
                "price"=>$cart['price'],
                "img"=>$cart['img'],
                "quantity"=>$cart['quantity'],
            );
        }



    }
    $_SESSION['cart']=$new_data;

}


// {
//     "cart_count": 1,
//     "cart_view": "<div class='container'>\n            <div class='row'>\n            <div class='col-xxl-8 col-xl-10 mx-auto'>\n                <div class='shadow-sm bg-white p-3 p-lg-4 rounded text-left'>\n                    <div class='mb-4'>\n                        <div class='row gutters-5 d-none d-lg-flex border-bottom mb-3 pb-3'>\n                            <div class='col-md-5 fw-600'>Product<\/div>\n                            <div class='col fw-600'>Price<\/div>\n                            <div class='col fw-600'>Tax<\/div>\n                            <div class='col fw-600'>Quantity<\/div>\n                            <div class='col fw-600'>Total<\/div>\n                            <div class='col-auto fw-600'>Remove<\/div>\n                        <\/div>\n                        <ul class='list-group list-group-flush'>\n                                                                                                                        <li class='list-group-item px-0 px-lg-3'>\n                                    <div class='row gutters-5'>\n                                        <div class='col-lg-5 d-flex'>\n                                            <span class='mr-2 ml-0'>\n                                                <img\n                                                    src='https:\/\/tmdtquocte.com\/public\/uploads\/all\/rzUAOzUAIyll8X8G6OhQnbwTE30826gUZt4bx542.jpg'\n                                                    class='img-fit size-60px rounded'\n                                                    alt='Iphone 15 pro max'\n                                                >\n                                            <\/span>\n                                            <span class='fs-14 opacity-60'>Iphone 15 pro max<\/span>\n                                        <\/div>\n\n                                        <div class='col-lg col-4 order-1 order-lg-0 my-3 my-lg-0'>\n                                            <span class='opacity-60 fs-12 d-block d-lg-none'>Price<\/span>\n                                            <span class='fw-600 fs-16'>849.15$<\/span>\n                                        <\/div>\n                                        <div class='col-lg col-4 order-2 order-lg-0 my-3 my-lg-0'>\n                                            <span class='opacity-60 fs-12 d-block d-lg-none'>Tax<\/span>\n                                            <span class='fw-600 fs-16'>0.00$<\/span>\n                                        <\/div>\n\n                                        <div class='col-lg col-6 order-4 order-lg-0'>\n                                                                                            <div class='row no-gutters align-items-center aiz-plus-minus mr-2 ml-0'>\n                                                    <button class='btn col-auto btn-icon btn-sm btn-circle btn-light' type='button' data-type='minus' data-field='quantity[9584]'>\n                                                        <i class='las la-minus'><\/i>\n                                                    <\/button>\n                                                    <input type='number' name='quantity[9584]' class='col border-0 text-center flex-grow-1 fs-16 input-number' placeholder='1' value='4' min='1' max='97' onchange='updateQuantity(9584, this)'>\n                                                    <button class='btn col-auto btn-icon btn-sm btn-circle btn-light' type='button' data-type='plus' data-field='quantity[9584]'>\n                                                        <i class='las la-plus'><\/i>\n                                                    <\/button>\n                                                <\/div>\n                                                                                    <\/div>\n                                        <div class='col-lg col-4 order-3 order-lg-0 my-3 my-lg-0'>\n                                            <span class='opacity-60 fs-12 d-block d-lg-none'>Total<\/span>\n                                            <span class='fw-600 fs-16 text-primary'>3,396.60$<\/span>\n                                        <\/div>\n                                        <div class='col-lg-auto col-6 order-5 order-lg-0 text-right'>\n                                            <a href='javascript:void(0)' onclick='removeFromCartView(event, 9584)' class='btn btn-icon btn-sm btn-soft-primary btn-circle'>\n                                                <i class='las la-trash'><\/i>\n                                            <\/a>\n                                        <\/div>\n                                    <\/div>\n                                <\/li>\n                                                    <\/ul>\n                    <\/div>\n\n                    <div class='px-3 py-2 mb-4 border-top d-flex justify-content-between'>\n                        <span class='opacity-60 fs-15'>Subtotal<\/span>\n                        <span class='fw-600 fs-17'>3,396.60$<\/span>\n                    <\/div>\n                    <div class='row align-items-center'>\n                        <div class='col-md-6 text-center text-md-left order-1 order-md-0'>\n                            <a href='https:\/\/tmdtquocte.com' class='btn btn-link'>\n                                <i class='las la-arrow-left'><\/i>\n                                Return to shop\n                            <\/a>\n                        <\/div>\n                        <div class='col-md-6 text-center text-md-right'>\n                                                            <button class='btn btn-primary fw-600' onclick='showCheckoutModal()'>Continue to Shipping<\/button>\n                                                    <\/div>\n                    <\/div>\n                <\/div>\n            <\/div>\n        <\/div>\n    <\/div>\n\n<script type='text\/javascript'>\n    AIZ.extra.plusMinus();\n<\/script>\n",
//     "nav_cart_view": "<a href='javascript:void(0)' class='d-flex align-items-center text-reset h-100' data-toggle='dropdown'\n    data-display='static'>\n    <i class='la la-shopping-cart la-2x opacity-80'><\/i>\n    <span class='flex-grow-1 ml-1'>\n                    <span class='badge badge-primary badge-inline badge-pill cart-count'>\n                1\n            <\/span>\n                <span class='nav-box-text d-none d-xl-block opacity-70'>Cart<\/span>\n    <\/span>\n<\/a>\n<div class='dropdown-menu dropdown-menu-right dropdown-menu-lg p-0 stop-propagation'>\n\n            <div class='p-3 fs-15 fw-600 p-3 border-bottom'>\n            Cart Items\n        <\/div>\n        <ul class='h-250px overflow-auto c-scrollbar-light list-group list-group-flush'>\n                                                                            <li class='list-group-item'>\n                        <span class='d-flex align-items-center'>\n                            <a href='https:\/\/tmdtquocte.com\/product\/iphone-15-pro-max-sG35i-6glAh-RnwJq'\n                                class='text-reset d-flex align-items-center flex-grow-1'>\n                                <img src='https:\/\/tmdtquocte.com\/public\/assets\/img\/placeholder.jpg'\n                                    data-src='https:\/\/tmdtquocte.com\/public\/uploads\/all\/rzUAOzUAIyll8X8G6OhQnbwTE30826gUZt4bx542.jpg'\n                                    class='img-fit lazyload size-60px rounded'\n                                    alt='Iphone 15 pro max'>\n                                <span class='minw-0 pl-2 flex-grow-1'>\n                                    <span class='fw-600 mb-1 text-truncate-2'>\n                                        Iphone 15 pro max\n                                    <\/span>\n                                    <span class='>4x<\/span>\n                                    \n                                    <span class='>849.15$<\/span>\n                                <\/span>\n                            <\/a>\n                            <span class='>\n                                <button onclick='removeFromCart(9584)'\n                                    class='btn btn-sm btn-icon stop-propagation'>\n                                    <i class='la la-close'><\/i>\n                                <\/button>\n                            <\/span>\n                        <\/span>\n                    <\/li>\n                                    <\/ul>\n        <div class='px-3 py-2 fs-15 border-top d-flex justify-content-between'>\n            <span class='opacity-60'>Subtotal<\/span>\n            <span class='fw-600'>3,396.60$<\/span>\n        <\/div>\n        <div class='px-3 py-2 text-center border-top'>\n            <ul class='list-inline mb-0'>\n                <li class='list-inline-item'>\n                    <a href='https:\/\/tmdtquocte.com\/cart' class='btn btn-soft-primary btn-sm'>\n                        View cart\n                    <\/a>\n                <\/li>\n                            <\/ul>\n        <\/div>\n    \n<\/div>\n"
// }
?>
